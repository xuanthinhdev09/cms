{{extend "layout.html"}}

<link href="{{=URL(c='static',f='plugin_layout/layout.css')}}" rel="stylesheet"/>
	   <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
	   <!--[if lt IE 9]>
	<script src="/js/html5shiv.js"></script>
<![endif]-->
	   <!-- Fav and touch icons -->

<script src="{{=URL(c='static',f='plugin_layout/js/jquery-ui.min.js')}}" type="text/javascript"></script>
<script src="{{=URL(c='static',f='plugin_layout/js/jquery.ui.touch-punch.min.js')}}" type="text/javascript"></script>
<script src="{{=URL(c='static',f='plugin_layout/js/jquery.htmlClean.js')}}" type="text/javascript"></script>
<script src="{{=URL(c='static',f='plugin_layout/js/scripts.min.js')}}" type="text/javascript"></script>
	
<div class='wr_layout'>	
<div class="edit" style="min-height: 534px; cursor: auto;">
  <div class="container">
   <div class="row">
    <div class="">
     <div class="sidebar-nav">
      <ul class="nav nav-list accordion-group">
       <li class="nav-header">
        <div class="pull-right popover-info">
         <i class="glyphicon glyphicon-question-sign">
         </i>
         <div class="popover fade right">
          <div class="arrow">
          </div>
          <h3 class="popover-title">
           Help
          </h3>
         </div>
        </div>
        <i class="glyphicon-plus glyphicon">
        </i>
        Grid system
       </li>
       <li class="rows" id="estRows" style="display: none;">
        
		<div class="lyrow ui-draggable">
         <a class="remove label label-danger" href="#close">
          <i class="glyphicon-remove glyphicon">
          </i>
          remove
         </a>
         <span class="drag label label-default">
          <i class="glyphicon glyphicon-move">
          </i>
          drag
         </span>
         <div class="preview">
          <input class="form-control" type="text" value="12"/>
         </div>
         <div class="view">
          <div class="  clearfix">
           <div class="col-md-12 column">
           </div>
          </div>
         </div>
        </div>
		
        <div class="lyrow ui-draggable">
         <a class="remove label label-danger" href="#close">
          <i class="glyphicon-remove glyphicon">
          </i>
          remove
         </a>
         <span class="drag label label-default">
          <i class="glyphicon glyphicon-move">
          </i>
          drag
         </span>
         <div class="preview">
          <input class="form-control" type="text" value="6 6"/>
         </div>
         <div class="view">
          <div class="  clearfix">
           <div class="col-md-6 column">
           </div>
           <div class="col-md-6 column">
           </div>
          </div>
         </div>
        </div>
        <div class="lyrow ui-draggable">
         <a class="remove label label-danger" href="#close">
          <i class="glyphicon-remove glyphicon">
          </i>
          remove
         </a>
         <span class="drag label label-default">
          <i class="glyphicon glyphicon-move">
          </i>
          drag
         </span>
         <div class="preview">
          <input class="form-control" type="text" value="8 4"/>
         </div>
         <div class="view">
          <div class="  clearfix">
           <div class="col-md-8 column">
           </div>
           <div class="col-md-4 column">
           </div>
          </div>
         </div>
        </div>
        <div class="lyrow ui-draggable">
         <a class="remove label label-danger" href="#close">
          <i class="glyphicon-remove glyphicon">
          </i>
          remove
         </a>
         <span class="drag label label-default">
          <i class="glyphicon glyphicon-move">
          </i>
          drag
         </span>
         <div class="preview">
          <input class="form-control" type="text" value="4 4 4"/>
         </div>
         <div class="view">
          <div class="  clearfix">
           <div class="col-md-4 column">
           </div>
           <div class="col-md-4 column">
           </div>
           <div class="col-md-4 column">
           </div>
          </div>
         </div>
        </div>
        <div class="lyrow ui-draggable">
         <a class="remove label label-danger" href="#close">
          <i class="glyphicon-remove glyphicon">
          </i>
          remove
         </a>
         <span class="drag label label-default">
          <i class="glyphicon glyphicon-move">
          </i>
          drag
         </span>
         <div class="preview">
          <input class="form-control" type="text" value="2 6 4"/>
         </div>
         <div class="view">
          <div class="clearfix">
           <div class="col-md-2 column">
           </div>
           <div class="col-md-6 column">
           </div>
           <div class="col-md-4 column">
           </div>
          </div>
         </div>
        </div>
		
		
		<div class="lyrow ui-draggable">
         <a class="remove label label-danger" href="#close">
          <i class="glyphicon-remove glyphicon">
          </i>
          remove
         </a>
         <span class="drag label label-default">
          <i class="glyphicon glyphicon-move">
          </i>
          drag
         </span>
         <div class="preview">
          <input class="form-control" type="text" value="3 9"/>
         </div>
         <div class="view">
				<div class="clearfix">
					<div class="col-md-3 column">
					</div>
					<div class="col-md-9 column">
					</div>
				</div>
         </div>
        </div>
		
		<div class="lyrow ui-draggable">
         <a class="remove label label-danger" href="#close">
          <i class="glyphicon-remove glyphicon">
          </i>
          remove
         </a>
         <span class="drag label label-default">
          <i class="glyphicon glyphicon-move">
          </i>
          drag
         </span>
         <div class="preview">
          <input class="form-control" type="text" value="Home 13"/>
         </div>
         <div class="view">
				<div class="clearfix" id='main_page'>
					<div class="col-md-3 column hidden-sm hidden-xs" id="sidebar_left">
					</div>
					<div class="col-md-9 column" id='main_content'>
					</div>
				</div>
         </div>
        </div>
		
		<div class="lyrow ui-draggable">
         <a class="remove label label-danger" href="#close">
          <i class="glyphicon-remove glyphicon">
          </i>
          remove
         </a>
         <span class="drag label label-default">
          <i class="glyphicon glyphicon-move">
          </i>
          drag
         </span>
         <div class="preview">
          <input class="form-control" type="text" value="Home 31"/>
         </div>
         <div class="view">
				<div class="clearfix" id='main_page'>
					
					<div class="col-md-9 column" id='main_content'>
					</div>
					<div class="col-md-3 column" id="sidebar_left">
					</div>
				</div>
         </div>
        </div>
		
		
		<div class="lyrow ui-draggable">
         <a class="remove label label-danger" href="#close">
          <i class="glyphicon-remove glyphicon">
          </i>
          remove
         </a>
         <span class="drag label label-default">
          <i class="glyphicon glyphicon-move">
          </i>
          drag
         </span>
         <div class="preview">
          <input class="form-control" type="text" value="Home 121"/>
         </div>
         <div class="view">
				<div class="clearfix" id='main_page'>
					<div class="col-md-3 column hidden-sm hidden-xs" id="sidebar_left">
					</div>
					<div class="col-md-6 column" id='main_content'>
					</div>
					<div class="col-md-3 column hidden-sm hidden-xs" id="sidebar_right">
					</div>
				</div>
         </div>
        </div>
		
		
       </li>
      </ul>

	  {{=portlets}}
	  
     </div>
    </div>
		
	
   
	<div class="btn-group">
		{{=files}}
	</div> 
	<div class="btn-group">
		<button class="btn btn-xs btn-primary" id="btnsave" role="button" type="button" onclick="update(0);">
			<i class="glyphicon-chevron-down glyphicon">
			</i>
			{{=T("Save layout")}}
		</button>
	</div>
	<div class="btn-group">
		<button class="btn btn-xs btn-primary" id="btnnew" role="button"  onclick="update(1);">
			<i class="glyphicon-share glyphicon">
			</i>
			{{=T("New layout")}}
		</button>
	</div>
	<div class="btn-group">
		<button class="btn btn-xs btn-primary" id="btnpreview" role="button"  onclick="preview();">
			<i class="glyphicon-share glyphicon">
			</i>
			{{=T("Preview layout")}}
		</button>
	</div>
	<br>	
	 <!--/span-->
    <div class="demo ui-sortable" id="container" style="min-height: 464px;">
		{{=content}}
    </div>
    <!--/span-->

	<div class="container">
	</div>
	
	
   </div>
   <!--/row-->
   
   
  </div>
</div>
  
<script type="text/javascript">
	$(document).ready(function(){
			});
</script>
  
  
<!--/.fluid-container-->
<script type="text/javascript">
	function update(newfile){
		var container = $("#container").html();
		if (newfile==1) {
			var filename=prompt("{{=T('Please enter new layout')}}",".html");
			if (filename==null) {
				return false;
			}	
		} else {
			var tmp = document.getElementById("filename").value.split('/');
			var filename = tmp[tmp.length-1];
			if (filename =='') return false;			
		}
		$.ajax({
			url: "{{=URL(r=request,c='plugin_layout',f='update',args=request.args)}}",
			type: "GET",
			data: {'container':container,'filename':filename},
			cache: false,
			success: function (html) {
				alert(html);
				if (newfile==1) {
					window.location = "{{=URL(r=request,c='plugin_layout',f='index')}}" + '/' + filename;
				}
			}
		});				
	}
	
	function preview(){
		var container = $("#container").html();
		$.ajax({
			url: "{{=URL(r=request,c='plugin_layout',f='update',args=request.args)}}",
			type: "GET",
			data: {'container':container,'filename':'preview.htm'},
			cache: false,
			success: function (html) {
				window.open("{{=URL(r=request,c='plugin_layout',f='preview')}}", "preview");
			}
		});				
	}  
	
	
</script>
</div>
